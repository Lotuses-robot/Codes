## Solution of 786B

首先，从起点 $s$ 到终点 $i$ 的最短路一定不会重复经过某条路径，即使这个路径类型是 $2$ 或 $3$。

可以证明路径类型是 $1$ 的时候是一定不会重新经过的。

当路径类型为 $2$ 的时候，当经过这条边时，会影响到当前到达这些点的最短距离（借鉴 Dijkstra 的思想）。

无论能否更新，都不会影响到源点的权值，而影响是否能更新（即能否走这条边）的条件就是起点的权值。再次更新的时候，如果不是由于当前源点重新被更好且不会经过终点（不然就不会更新）的时候才会再次更新。

当路径类型为 $3$ 的时候，与路径为 $1$ 的思想是一样的，都是由于边权非负。

而套上 Dijkstra，实际上就是在维护一个到起点的距离序列。而这个有多个起终点的边就相当于在这个序列上做一个区间最小的查询和更新。

由于边权的相同，就使得区间更新查询有了用武之地。（为什么如果边权不相同就不能用了呢）

那么一个线段树套 Dijkstra 就差不多了把？