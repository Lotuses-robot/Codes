设循环节长度为 $d$，$k$ 为循环次数；

1. 若一个数在原来的点上，那么这个点必然是在一个长度为 $d\in\{d' | k \equiv 0 \pmod {d'}\}$ 的循环上。

   所有在原来点上的数的情况的总和 就是 所有点相互结合之后可以满足每个点都在长度为 $d$ 的循环上的情况数。

   这个情况与其他点无关，单独计算且相乘。

2. 若一个数没有出现在原来的点上，那么寻找当前位置应当对应的点。设寻找了 $q$ 次，这样能构成许多个循环。这些很多个循环组合在一起，设他们在一个 $S$ 里面，那么很神奇的，将 ta 们相互组合，满足要组合在一起的 ta 们 $q = q' + |\text{add}|, d=d'+|add|$，并且满足 $k \equiv q \pmod {d}$，这样的 $d$ 个数乘上组合的方案数 就是一种合法的情况。

   问题转化为在 $s\in Q$ 中任意组合 $s_i = s_j$ 的，计算 $\sum_{s}|\{k\equiv q_{s} \pmod{d'}\}|$。

---

？

不应该对应一个大的循环中只可能有一个 $q$ 满足条件吗？

$k\bmod b = ?$

不应当这个结果是 $\ge 0\ \and < b$ 的吗？那么一个循环必然就只能有一个可能的构造使他满足这个条件捏。

对于在原来点上的点，肯定可以构造 $k\bmod b = 0$？其实这个仅仅为构造问题而已？

而且这个构造对于每一个可以单独组合的都是成立的？

为什么在样例中不能单独将 $[1,2]$ 放在一起呢？

---

显然上面的想法不太对劲。因为在一个循环中，最后第几个循环的次数 $q$ 是确定的？

对于每一个循环，都可以通过向前指向后指的方式找到一个 $q = 1$ 的做法。

那么为什么不可能通过再次向前指，寻找到 $q$ 更小的吗？因为在某些情况下，向前寻找两次会让整个循环断开来。

1->2 2->3 3->4 4->1 没有问题，

但是 1->3 2->4 3->1 4->2 就变成了两个循环！

那么只要是 $d\bmod q = 0$ ，$q$ 作为第几个循环时不成立。

$d\bmod (k\bmod d) = 0$ 那么就不可能。

若 $k\bmod d = 0$ 除非在原位有可能，其他都不可能。

$q = k\bmod d$。
